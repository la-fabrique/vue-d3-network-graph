(function($,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","@vueuse/core"],a):($=typeof globalThis<"u"?globalThis:$||self,a($["vue-d3-network-graph"]={},$.Vue,$.VueUseCore))})(this,function($,a,ee){"use strict";function Fe(e,n){const r=a.ref(void 0),t=a.reactive({x:0,y:0}),o=f=>{let g,x=0;return f instanceof MouseEvent?(g=f.clientX,x=f.clientY):f instanceof TouchEvent&&(g=f.touches[0].clientX,x=f.touches[0].clientY),{x:g||0,y:x||0}},s=(f,g)=>n.value?(()=>{r.value=g,c(f,e.value.nodes()[g])})():void 0,c=(f,g)=>{let x=0,d=0;if(f&&g&&(g!=null&&g.x)&&(g!=null&&g.y)){const _=o(f);x=_.x?_.x-g.x:g.x,d=_.y?_.y-g.y:g.y}t.x=x,t.y=d},l=()=>{if(r.value!==void 0){const f=e.value.nodes()[r.value];f.fx=null,f.fy=null,h()}},h=()=>{r.value=void 0,e.value.alpha(.1),e.value.restart(),c()};return{dragStart:s,dragEnd:l,dragMove:f=>{const g=o(f);r.value!=null&&e.value.nodes()[r.value]&&(e.value.restart(),e.value.alpha(.5),e.value.nodes()[r.value].fx=g.x-t.x,e.value.nodes()[r.value].fy=g.y-t.y)}}}const ie="arrow-start",ae="arrow-end";function Pe(e,n,r){const t=c=>r.value&&c.twoWay?`url(#${ie})`:void 0,o=c=>r.value?`url(#${ae})`:void 0,s=a.computed(()=>({arrowStart:{id:ie,refX:-(n.value/2-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"stroke-width":"1","marker-units":"userSpaceOnUse"},arrowEnd:{id:ae,refX:n.value/2+(10-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"marker-units":"userSpaceOnUse"}}));return{getMarkerEnd:o,getMarkerStart:t,markers:s}}function Ie(e){const n=+this._x.call(null,e),r=+this._y.call(null,e);return se(this.cover(n,r),n,r,e)}function se(e,n,r,t){if(isNaN(n)||isNaN(r))return e;var o,s=e._root,c={data:t},l=e._x0,h=e._y0,i=e._x1,f=e._y1,g,x,d,_,y,u,v,p;if(!s)return e._root=c,e;for(;s.length;)if((y=n>=(g=(l+i)/2))?l=g:i=g,(u=r>=(x=(h+f)/2))?h=x:f=x,o=s,!(s=s[v=u<<1|y]))return o[v]=c,e;if(d=+e._x.call(null,s.data),_=+e._y.call(null,s.data),n===d&&r===_)return c.next=s,o?o[v]=c:e._root=c,e;do o=o?o[v]=new Array(4):e._root=new Array(4),(y=n>=(g=(l+i)/2))?l=g:i=g,(u=r>=(x=(h+f)/2))?h=x:f=x;while((v=u<<1|y)===(p=(_>=x)<<1|d>=g));return o[p]=s,o[v]=c,e}function $e(e){var n,r,t=e.length,o,s,c=new Array(t),l=new Array(t),h=1/0,i=1/0,f=-1/0,g=-1/0;for(r=0;r<t;++r)isNaN(o=+this._x.call(null,n=e[r]))||isNaN(s=+this._y.call(null,n))||(c[r]=o,l[r]=s,o<h&&(h=o),o>f&&(f=o),s<i&&(i=s),s>g&&(g=s));if(h>f||i>g)return this;for(this.cover(h,i).cover(f,g),r=0;r<t;++r)se(this,c[r],l[r],e[r]);return this}function Ye(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,t=this._y0,o=this._x1,s=this._y1;if(isNaN(r))o=(r=Math.floor(e))+1,s=(t=Math.floor(n))+1;else{for(var c=o-r||1,l=this._root,h,i;r>e||e>=o||t>n||n>=s;)switch(i=(n<t)<<1|e<r,h=new Array(4),h[i]=l,l=h,c*=2,i){case 0:o=r+c,s=t+c;break;case 1:r=o-c,s=t+c;break;case 2:o=r+c,t=s-c;break;case 3:r=o-c,t=s-c;break}this._root&&this._root.length&&(this._root=l)}return this._x0=r,this._y0=t,this._x1=o,this._y1=s,this}function Xe(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function Ve(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function L(e,n,r,t,o){this.node=e,this.x0=n,this.y0=r,this.x1=t,this.y1=o}function We(e,n,r){var t,o=this._x0,s=this._y0,c,l,h,i,f=this._x1,g=this._y1,x=[],d=this._root,_,y;for(d&&x.push(new L(d,o,s,f,g)),r==null?r=1/0:(o=e-r,s=n-r,f=e+r,g=n+r,r*=r);_=x.pop();)if(!(!(d=_.node)||(c=_.x0)>f||(l=_.y0)>g||(h=_.x1)<o||(i=_.y1)<s))if(d.length){var u=(c+h)/2,v=(l+i)/2;x.push(new L(d[3],u,v,h,i),new L(d[2],c,v,u,i),new L(d[1],u,l,h,v),new L(d[0],c,l,u,v)),(y=(n>=v)<<1|e>=u)&&(_=x[x.length-1],x[x.length-1]=x[x.length-1-y],x[x.length-1-y]=_)}else{var p=e-+this._x.call(null,d.data),k=n-+this._y.call(null,d.data),w=p*p+k*k;if(w<r){var N=Math.sqrt(r=w);o=e-N,s=n-N,f=e+N,g=n+N,t=d.data}}return t}function He(e){if(isNaN(f=+this._x.call(null,e))||isNaN(g=+this._y.call(null,e)))return this;var n,r=this._root,t,o,s,c=this._x0,l=this._y0,h=this._x1,i=this._y1,f,g,x,d,_,y,u,v;if(!r)return this;if(r.length)for(;;){if((_=f>=(x=(c+h)/2))?c=x:h=x,(y=g>=(d=(l+i)/2))?l=d:i=d,n=r,!(r=r[u=y<<1|_]))return this;if(!r.length)break;(n[u+1&3]||n[u+2&3]||n[u+3&3])&&(t=n,v=u)}for(;r.data!==e;)if(o=r,!(r=r.next))return this;return(s=r.next)&&delete r.next,o?(s?o.next=s:delete o.next,this):n?(s?n[u]=s:delete n[u],(r=n[0]||n[1]||n[2]||n[3])&&r===(n[3]||n[2]||n[1]||n[0])&&!r.length&&(t?t[v]=r:this._root=r),this):(this._root=s,this)}function Ue(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function je(){return this._root}function Ge(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function Oe(e){var n=[],r,t=this._root,o,s,c,l,h;for(t&&n.push(new L(t,this._x0,this._y0,this._x1,this._y1));r=n.pop();)if(!e(t=r.node,s=r.x0,c=r.y0,l=r.x1,h=r.y1)&&t.length){var i=(s+l)/2,f=(c+h)/2;(o=t[3])&&n.push(new L(o,i,f,l,h)),(o=t[2])&&n.push(new L(o,s,f,i,h)),(o=t[1])&&n.push(new L(o,i,c,l,f)),(o=t[0])&&n.push(new L(o,s,c,i,f))}return this}function Ke(e){var n=[],r=[],t;for(this._root&&n.push(new L(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var o=t.node;if(o.length){var s,c=t.x0,l=t.y0,h=t.x1,i=t.y1,f=(c+h)/2,g=(l+i)/2;(s=o[0])&&n.push(new L(s,c,l,f,g)),(s=o[1])&&n.push(new L(s,f,l,h,g)),(s=o[2])&&n.push(new L(s,c,g,f,i)),(s=o[3])&&n.push(new L(s,f,g,h,i))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function Qe(e){return e[0]}function Ze(e){return arguments.length?(this._x=e,this):this._x}function Je(e){return e[1]}function qe(e){return arguments.length?(this._y=e,this):this._y}function te(e,n,r){var t=new ne(n??Qe,r??Je,NaN,NaN,NaN,NaN);return e==null?t:t.addAll(e)}function ne(e,n,r,t,o,s){this._x=e,this._y=n,this._x0=r,this._y0=t,this._x1=o,this._y1=s,this._root=void 0}function le(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var B=te.prototype=ne.prototype;B.copy=function(){var e=new ne(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,r,t;if(!n)return e;if(!n.length)return e._root=le(n),e;for(r=[{source:n,target:e._root=new Array(4)}];n=r.pop();)for(var o=0;o<4;++o)(t=n.source[o])&&(t.length?r.push({source:t,target:n.target[o]=new Array(4)}):n.target[o]=le(t));return e},B.add=Ie,B.addAll=$e,B.cover=Ye,B.data=Xe,B.extent=Ve,B.find=We,B.remove=He,B.removeAll=Ue,B.root=je,B.size=Ge,B.visit=Oe,B.visitAfter=Ke,B.x=Ze,B.y=qe;function F(e){return function(){return e}}function Y(e){return(e()-.5)*1e-6}function et(e){return e.x+e.vx}function tt(e){return e.y+e.vy}function nt(e){var n,r,t,o=1,s=1;typeof e!="function"&&(e=F(e==null?1:+e));function c(){for(var i,f=n.length,g,x,d,_,y,u,v=0;v<s;++v)for(g=te(n,et,tt).visitAfter(l),i=0;i<f;++i)x=n[i],y=r[x.index],u=y*y,d=x.x+x.vx,_=x.y+x.vy,g.visit(p);function p(k,w,N,R,T){var E=k.data,C=k.r,S=y+C;if(E){if(E.index>x.index){var P=d-E.x-E.vx,I=_-E.y-E.vy,D=P*P+I*I;D<S*S&&(P===0&&(P=Y(t),D+=P*P),I===0&&(I=Y(t),D+=I*I),D=(S-(D=Math.sqrt(D)))/D*o,x.vx+=(P*=D)*(S=(C*=C)/(u+C)),x.vy+=(I*=D)*S,E.vx-=P*(S=1-S),E.vy-=I*S)}return}return w>d+S||R<d-S||N>_+S||T<_-S}}function l(i){if(i.data)return i.r=r[i.data.index];for(var f=i.r=0;f<4;++f)i[f]&&i[f].r>i.r&&(i.r=i[f].r)}function h(){if(n){var i,f=n.length,g;for(r=new Array(f),i=0;i<f;++i)g=n[i],r[g.index]=+e(g,i,n)}}return c.initialize=function(i,f){n=i,t=f,h()},c.iterations=function(i){return arguments.length?(s=+i,c):s},c.strength=function(i){return arguments.length?(o=+i,c):o},c.radius=function(i){return arguments.length?(e=typeof i=="function"?i:F(+i),h(),c):e},c}function rt(e){return e.index}function ce(e,n){var r=e.get(n);if(!r)throw new Error("node not found: "+n);return r}function ot(e){var n=rt,r=g,t,o=F(30),s,c,l,h,i,f=1;e==null&&(e=[]);function g(u){return 1/Math.min(l[u.source.index],l[u.target.index])}function x(u){for(var v=0,p=e.length;v<f;++v)for(var k=0,w,N,R,T,E,C,S;k<p;++k)w=e[k],N=w.source,R=w.target,T=R.x+R.vx-N.x-N.vx||Y(i),E=R.y+R.vy-N.y-N.vy||Y(i),C=Math.sqrt(T*T+E*E),C=(C-s[k])/C*u*t[k],T*=C,E*=C,R.vx-=T*(S=h[k]),R.vy-=E*S,N.vx+=T*(S=1-S),N.vy+=E*S}function d(){if(c){var u,v=c.length,p=e.length,k=new Map(c.map((N,R)=>[n(N,R,c),N])),w;for(u=0,l=new Array(v);u<p;++u)w=e[u],w.index=u,typeof w.source!="object"&&(w.source=ce(k,w.source)),typeof w.target!="object"&&(w.target=ce(k,w.target)),l[w.source.index]=(l[w.source.index]||0)+1,l[w.target.index]=(l[w.target.index]||0)+1;for(u=0,h=new Array(p);u<p;++u)w=e[u],h[u]=l[w.source.index]/(l[w.source.index]+l[w.target.index]);t=new Array(p),_(),s=new Array(p),y()}}function _(){if(c)for(var u=0,v=e.length;u<v;++u)t[u]=+r(e[u],u,e)}function y(){if(c)for(var u=0,v=e.length;u<v;++u)s[u]=+o(e[u],u,e)}return x.initialize=function(u,v){c=u,i=v,d()},x.links=function(u){return arguments.length?(e=u,d(),x):e},x.id=function(u){return arguments.length?(n=u,x):n},x.iterations=function(u){return arguments.length?(f=+u,x):f},x.strength=function(u){return arguments.length?(r=typeof u=="function"?u:F(+u),_(),x):r},x.distance=function(u){return arguments.length?(o=typeof u=="function"?u:F(+u),y(),x):o},x}var it={value:()=>{}};function fe(){for(var e=0,n=arguments.length,r={},t;e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new O(r)}function O(e){this._=e}function at(e,n){return e.trim().split(/^|\s+/).map(function(r){var t="",o=r.indexOf(".");if(o>=0&&(t=r.slice(o+1),r=r.slice(0,o)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:t}})}O.prototype=fe.prototype={constructor:O,on:function(e,n){var r=this._,t=at(e+"",r),o,s=-1,c=t.length;if(arguments.length<2){for(;++s<c;)if((o=(e=t[s]).type)&&(o=st(r[o],e.name)))return o;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++s<c;)if(o=(e=t[s]).type)r[o]=ue(r[o],e.name,n);else if(n==null)for(o in r)r[o]=ue(r[o],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new O(e)},call:function(e,n){if((o=arguments.length-2)>0)for(var r=new Array(o),t=0,o,s;t<o;++t)r[t]=arguments[t+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],t=0,o=s.length;t<o;++t)s[t].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var t=this._[e],o=0,s=t.length;o<s;++o)t[o].value.apply(n,r)}};function st(e,n){for(var r=0,t=e.length,o;r<t;++r)if((o=e[r]).name===n)return o.value}function ue(e,n,r){for(var t=0,o=e.length;t<o;++t)if(e[t].name===n){e[t]=it,e=e.slice(0,t).concat(e.slice(t+1));break}return r!=null&&e.push({name:n,value:r}),e}var V=0,H=0,U=0,he=1e3,K,j,Q=0,X=0,Z=0,G=typeof performance=="object"&&performance.now?performance:Date,ge=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function ye(){return X||(ge(lt),X=G.now()+Z)}function lt(){X=0}function re(){this._call=this._time=this._next=null}re.prototype=de.prototype={constructor:re,restart:function(e,n,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?ye():+r)+(n==null?0:+n),!this._next&&j!==this&&(j?j._next=this:K=this,j=this),this._call=e,this._time=r,oe()},stop:function(){this._call&&(this._call=null,this._time=1/0,oe())}};function de(e,n,r){var t=new re;return t.restart(e,n,r),t}function ct(){ye(),++V;for(var e=K,n;e;)(n=X-e._time)>=0&&e._call.call(void 0,n),e=e._next;--V}function ve(){X=(Q=G.now())+Z,V=H=0;try{ct()}finally{V=0,ut(),X=0}}function ft(){var e=G.now(),n=e-Q;n>he&&(Z-=n,Q=e)}function ut(){for(var e,n=K,r,t=1/0;n;)n._call?(t>n._time&&(t=n._time),e=n,n=n._next):(r=n._next,n._next=null,n=e?e._next=r:K=r);j=e,oe(t)}function oe(e){if(!V){H&&(H=clearTimeout(H));var n=e-X;n>24?(e<1/0&&(H=setTimeout(ve,e-G.now()-Z)),U&&(U=clearInterval(U))):(U||(Q=G.now(),U=setInterval(ft,he)),V=1,ge(ve))}}const ht=1664525,gt=1013904223,xe=4294967296;function yt(){let e=1;return()=>(e=(ht*e+gt)%xe)/xe}function dt(e){return e.x}function vt(e){return e.y}var xt=10,_t=Math.PI*(3-Math.sqrt(5));function _e(e){var n,r=1,t=.001,o=1-Math.pow(t,1/300),s=0,c=.6,l=new Map,h=de(g),i=fe("tick","end"),f=yt();e==null&&(e=[]);function g(){x(),i.call("tick",n),r<t&&(h.stop(),i.call("end",n))}function x(y){var u,v=e.length,p;y===void 0&&(y=1);for(var k=0;k<y;++k)for(r+=(s-r)*o,l.forEach(function(w){w(r)}),u=0;u<v;++u)p=e[u],p.fx==null?p.x+=p.vx*=c:(p.x=p.fx,p.vx=0),p.fy==null?p.y+=p.vy*=c:(p.y=p.fy,p.vy=0);return n}function d(){for(var y=0,u=e.length,v;y<u;++y){if(v=e[y],v.index=y,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var p=xt*Math.sqrt(.5+y),k=y*_t;v.x=p*Math.cos(k),v.y=p*Math.sin(k)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function _(y){return y.initialize&&y.initialize(e,f),y}return d(),n={tick:x,restart:function(){return h.restart(g),n},stop:function(){return h.stop(),n},nodes:function(y){return arguments.length?(e=y,d(),l.forEach(_),n):e},alpha:function(y){return arguments.length?(r=+y,n):r},alphaMin:function(y){return arguments.length?(t=+y,n):t},alphaDecay:function(y){return arguments.length?(o=+y,n):+o},alphaTarget:function(y){return arguments.length?(s=+y,n):s},velocityDecay:function(y){return arguments.length?(c=1-y,n):1-c},randomSource:function(y){return arguments.length?(f=y,l.forEach(_),n):f},force:function(y,u){return arguments.length>1?(u==null?l.delete(y):l.set(y,_(u)),n):l.get(y)},find:function(y,u,v){var p=0,k=e.length,w,N,R,T,E;for(v==null?v=1/0:v*=v,p=0;p<k;++p)T=e[p],w=y-T.x,N=u-T.y,R=w*w+N*N,R<v&&(E=T,v=R);return E},on:function(y,u){return arguments.length>1?(i.on(y,u),n):i.on(y)}}}function pt(){var e,n,r,t,o=F(-30),s,c=1,l=1/0,h=.81;function i(d){var _,y=e.length,u=te(e,dt,vt).visitAfter(g);for(t=d,_=0;_<y;++_)n=e[_],u.visit(x)}function f(){if(e){var d,_=e.length,y;for(s=new Array(_),d=0;d<_;++d)y=e[d],s[y.index]=+o(y,d,e)}}function g(d){var _=0,y,u,v=0,p,k,w;if(d.length){for(p=k=w=0;w<4;++w)(y=d[w])&&(u=Math.abs(y.value))&&(_+=y.value,v+=u,p+=u*y.x,k+=u*y.y);d.x=p/v,d.y=k/v}else{y=d,y.x=y.data.x,y.y=y.data.y;do _+=s[y.data.index];while(y=y.next)}d.value=_}function x(d,_,y,u){if(!d.value)return!0;var v=d.x-n.x,p=d.y-n.y,k=u-_,w=v*v+p*p;if(k*k/h<w)return w<l&&(v===0&&(v=Y(r),w+=v*v),p===0&&(p=Y(r),w+=p*p),w<c&&(w=Math.sqrt(c*w)),n.vx+=v*d.value*t/w,n.vy+=p*d.value*t/w),!0;if(d.length||w>=l)return;(d.data!==n||d.next)&&(v===0&&(v=Y(r),w+=v*v),p===0&&(p=Y(r),w+=p*p),w<c&&(w=Math.sqrt(c*w)));do d.data!==n&&(k=s[d.data.index]*t/w,n.vx+=v*k,n.vy+=p*k);while(d=d.next)}return i.initialize=function(d,_){e=d,r=_,f()},i.strength=function(d){return arguments.length?(o=typeof d=="function"?d:F(+d),f(),i):o},i.distanceMin=function(d){return arguments.length?(c=d*d,i):Math.sqrt(c)},i.distanceMax=function(d){return arguments.length?(l=d*d,i):Math.sqrt(l)},i.theta=function(d){return arguments.length?(h=d*d,i):Math.sqrt(h)},i}function wt(e){var n=F(.1),r,t,o;typeof e!="function"&&(e=F(e==null?0:+e));function s(l){for(var h=0,i=r.length,f;h<i;++h)f=r[h],f.vx+=(o[h]-f.x)*t[h]*l}function c(){if(r){var l,h=r.length;for(t=new Array(h),o=new Array(h),l=0;l<h;++l)t[l]=isNaN(o[l]=+e(r[l],l,r))?0:+n(r[l],l,r)}}return s.initialize=function(l){r=l,c()},s.strength=function(l){return arguments.length?(n=typeof l=="function"?l:F(+l),c(),s):n},s.x=function(l){return arguments.length?(e=typeof l=="function"?l:F(+l),c(),s):e},s}function mt(e){var n=F(.1),r,t,o;typeof e!="function"&&(e=F(e==null?0:+e));function s(l){for(var h=0,i=r.length,f;h<i;++h)f=r[h],f.vy+=(o[h]-f.y)*t[h]*l}function c(){if(r){var l,h=r.length;for(t=new Array(h),o=new Array(h),l=0;l<h;++l)t[l]=isNaN(o[l]=+e(r[l],l,r))?0:+n(r[l],l,r)}}return s.initialize=function(l){r=l,c()},s.strength=function(l){return arguments.length?(n=typeof l=="function"?l:F(+l),c(),s):n},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:F(+l),c(),s):e},s}function kt(e){const n=i=>i||e.value,r=i=>i.width||e.value,t=i=>i.height||i.size||e.value,o=i=>i.color?"fill: "+i.color:"",s=(i,f)=>i||f?["node","pinned"]:["node"];return{getNode:(i,f,g)=>({id:i.id,key:i.id,x:f,y:g,viewBox:i.innerSVG,width:r(i),height:t(i),name:i.name,style:o(i),title:i.name,cssClass:s(),r:i.innerSVG?void 0:n(i.size)/2}),getClass:s,getSize:n,getX:(i,f)=>(i||0)-(f||0)/2,getY:(i,f)=>(i||0)-(f||0)/2}}const Mt="arrow-start",Nt="arrow-end";function Et(e,n,r){const t=h=>h.color?{stroke:h.color}:void 0,o=h=>["link"],s=h=>r.value&&h.twoWay?`url(#${Mt})`:void 0,c=h=>r.value?`url(#${Nt})`:void 0;return{getClass:o,getStyle:t,getMarkerEnd:c,getMarkerStart:s,getSimulationLink:h=>({source:h.source,target:h.target,name:h.name,class:o(h.id),style:t(h),"stroke-width":e.value,"marker-end":c(),"marker-start":s(h)})}}const St="X",At="Y",Rt="charge",Tt="link",bt="collide",pe=.01,we=.1,zt=Math.log(pe)/Math.log(1-we);function me(e,n,r,t){const{getNode:o}=kt(t.nodeSize),{getSimulationLink:s}=Et(t.linkWidth,t.nodeSize,t.directed),c=a.reactive({nodes:[],links:[]}),l=()=>{console.debug("useSimulation.init"),c.nodes=e.value.map(g=>o(g)),c.links=n.value.map(g=>s(g)),h()},h=async()=>{console.debug("useSimulation.refresh"),f.value.stop(),f.value=i(),t.static.value?f.value.tick(zt):f.value.restart()},i=()=>{const g=_e().alphaMin(pe).alphaDecay(we).nodes(c.nodes);return g.force(St,wt(r.value.width/2).strength(t.forceXStrength.value)),g.force(At,mt(r.value.height/2).strength(t.forceYStrength.value)),g.force(Rt,pt().strength(t.forcManyBodyStrength.value)),g.force(bt,nt(t.forceCollideStrength.value)),g.force(Tt,ot(c.links).id(x=>{if(!("id"in x))throw new Error("Node id is undefined");return x.id})),g},f=a.ref(_e());return ee.watchDebounced([()=>e.value.length,()=>n.value.length,r,t.nodeSize,t.linkWidth,t.forcManyBodyStrength,t.forceXStrength,t.forceYStrength,t.forceCollideStrength,t.directed],async()=>l(),{debounce:100,maxWait:1e3}),ee.watchDebounced(t.static,async()=>h(),{deep:!0,debounce:100,maxWait:1e3}),{simulation:f,graph:c}}const Ct=.1,Dt=.1,Lt=-300,Bt=25,Ft=12,Pt=2,It=45,$t=e=>{const n=a.computed(()=>{var t,o,s,c,l,h,i,f,g,x,d,_,y,u,v,p,k,w,N,R,T,E,C,S,P,I,D,J,q,M,z,m,b,A,ke,Me,Ne,Ee,Se,Ae,Re,Te,be,ze,Ce,De,Le,Be;return{node:{stroke:((s=(o=(t=e.value)==null?void 0:t.nodes)==null?void 0:o.colors)==null?void 0:s.stroke)||"#E2EB98",fill:((h=(l=(c=e.value)==null?void 0:c.nodes)==null?void 0:l.colors)==null?void 0:h.fill)||"#93A392",selected:{stroke:((x=(g=(f=(i=e.value)==null?void 0:i.nodes)==null?void 0:f.colors)==null?void 0:g.selected)==null?void 0:x.stroke)||"#9DC4B5",fill:(u=(y=(_=(d=e.value)==null?void 0:d.nodes)==null?void 0:_.colors)==null?void 0:y.selected)==null?void 0:u.fill},hover:{stroke:"#9DC4B5",fill:(w=(k=(p=(v=e.value)==null?void 0:v.nodes)==null?void 0:p.colors)==null?void 0:k.hover)==null?void 0:w.fill},pinned:{stroke:"#9DC4B5",fill:(E=(T=(R=(N=e.value)==null?void 0:N.nodes)==null?void 0:R.colors)==null?void 0:T.pinned)==null?void 0:E.fill},label:{fill:((I=(P=(S=(C=e.value)==null?void 0:C.nodes)==null?void 0:S.colors)==null?void 0:P.label)==null?void 0:I.fill)||"#93A392"}},link:{stroke:((q=(J=(D=e.value)==null?void 0:D.links)==null?void 0:J.colors)==null?void 0:q.stroke)||"#BAD9A2",fill:(m=(z=(M=e.value)==null?void 0:M.links)==null?void 0:z.colors)==null?void 0:m.fill,selected:{stroke:((Me=(ke=(A=(b=e.value)==null?void 0:b.links)==null?void 0:A.colors)==null?void 0:ke.selected)==null?void 0:Me.stroke)||"#9DC4B5",fill:(Ae=(Se=(Ee=(Ne=e.value)==null?void 0:Ne.links)==null?void 0:Ee.colors)==null?void 0:Se.selected)==null?void 0:Ae.fill},hover:{stroke:"#9DC4B5",fill:(ze=(be=(Te=(Re=e.value)==null?void 0:Re.links)==null?void 0:Te.colors)==null?void 0:be.hover)==null?void 0:ze.fill},label:{fill:((Be=(Le=(De=(Ce=e.value)==null?void 0:Ce.links)==null?void 0:De.colors)==null?void 0:Le.label)==null?void 0:Be.fill)||"#93A392"}}}});return{options:{static:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.simulation)==null?void 0:o.static)||!1}),forceXStrength:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.simulation)==null?void 0:o.force.x)||Ct}),forceYStrength:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.simulation)==null?void 0:o.force.y)||Dt}),forcManyBodyStrength:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.simulation)==null?void 0:o.force.charge)||Lt}),forceCollideStrength:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.simulation)==null?void 0:o.force.collide)||It}),nodeSize:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.nodes)==null?void 0:o.size)||Bt}),nodeFontSize:a.toRef(()=>{var t,o,s;return((s=(o=(t=e.value)==null?void 0:t.nodes)==null?void 0:o.font)==null?void 0:s.size)||Ft}),linkWidth:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.links)==null?void 0:o.width)||Pt}),linkFontSize:a.toRef(()=>{var t,o,s;return((s=(o=(t=e.value)==null?void 0:t.links)==null?void 0:o.font)==null?void 0:s.size)||12}),draggables:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.layout)==null?void 0:o.draggables)||!1}),directed:a.toRef(()=>{var t,o;return((o=(t=e.value)==null?void 0:t.layout)==null?void 0:o.directed)||!1})},theme:n}},Yt=(e,n)=>({label:a.computed(()=>({font:{size:e.value},offset:{x:n.value/2+e.value/2,y:e.value/2}}))}),W=e=>!!e&&typeof e!="number"&&typeof e!="string",Xt=e=>({label:a.computed(()=>({font:{size:e.value}})),getX:o=>W(o.source)&&W(o.target)&&o.source.x&&o.target.x?o.target.x>o.source.x?o.source.x+(o.target.x-o.source.x)/2:o.target.x+(o.source.x-o.target.x)/2:void 0,getY:o=>W(o.source)&&W(o.target)&&o.source.y&&o.target.y?o.target.y>o.source.y?o.source.y+(o.target.y-o.source.y)/2:o.target.y+(o.source.y-o.target.y)/2:void 0}),Vt=e=>{const n=a.ref({Sx:1,Qx:0,Qy:0,Sy:1,Tx:0,Ty:0}),r=a.computed(()=>`matrix(${n.value.Sx},${n.value.Qx},${n.value.Qy},${n.value.Sy},${n.value.Tx},${n.value.Ty})`),t={x:0,y:0},o=g=>g>=.5&&g<=4,s=()=>t.x!==0&&t.y!==0,c=(g,x,d,_)=>({x:g-_,y:x-d});return{transform:r,zoom:(g,x,d)=>{const _=n.value.Sx+d;if(!o(_))return;const y=c(g,x,e.value.top,e.value.left);n.value.Tx=_/n.value.Sx*(n.value.Tx-y.x)+y.x,n.value.Ty=_/n.value.Sx*(n.value.Ty-y.y)+y.y,n.value.Sx=_,n.value.Sy=_},panMove:(g,x)=>{if(!s())return;const d=g-t.x,_=x-t.y;n.value.Tx+=d,n.value.Ty+=_,t.x=g,t.y=x},panStart:(g,x)=>{t.x=g,t.y=x},panEnd:()=>{t.x=0,t.y=0}}},Wt=["viewBox","onMousedown","onWheel"],Ht={key:0},Ut=["fill"],jt=["fill"],Gt=["transform"],Ot={class:"links"},Kt=["id","d","stroke-width","marker-end","marker-start","onClick","onTouchstartPassive"],Qt=["font-size","x","y"],Zt={id:"l-nodes",class:"nodes"},Jt=["viewBox","width","height","x","y","title","onClick","onTouchendPassive","onMousedown","onTouchstartPassive","innerHTML"],qt=["cx","cy","r","title","onClick","onTouchendPassive","onMousedown","onTouchstartPassive"],en=["x","y","font-size"],tn=a.defineComponent({__name:"D3NetworkGraph",props:{nodes:{type:Array,required:!0},links:{type:Array,required:!0},options:{type:Object,default:void 0}},emits:["node-click","link-click"],setup(e,{emit:n}){const r=e;a.useCssVars(M=>({"2c3695d2":a.unref(t).node.stroke,"1ea8339d":a.unref(t).node.fill,"79f1048e":a.unref(t).node.selected.stroke||a.unref(t).node.stroke,"147925ee":a.unref(t).node.selected.fill||a.unref(t).node.fill,a594526a:a.unref(t).node.pinned.stroke||a.unref(t).node.stroke,"76d29eab":a.unref(t).node.pinned.fill||a.unref(t).node.fill,"4359ac8a":a.unref(t).node.hover.stroke||a.unref(t).node.stroke,"75eee99b":a.unref(t).node.hover.fill||a.unref(t).node.fill,fab0264c:a.unref(t).link.stroke,bbd8a6b6:a.unref(t).link.fill,"2c5bf489":a.unref(t).link.selected.stroke,"1333d414":a.unref(t).link.selected.fill,"1ef63b44":a.unref(t).node.hover.stroke,d8d2e4e2:a.unref(t).node.hover.fill,bcef8442:a.unref(t).link.label.fill,"2129aad7":a.unref(t).node.label.fill}));const{theme:t,options:o}=$t(a.toRef(()=>r.options)),s=a.ref(null),c=a.ref(null),l=a.ref({width:100,height:100,top:0,left:0}),{transform:h,zoom:i,panMove:f,panStart:g,panEnd:x}=Vt(l);ee.useResizeObserver(s,M=>{const z=M[0];if(z.contentRect.width===l.value.width&&z.contentRect.height===l.value.height)return;const m=z.target.getBoundingClientRect();l.value={top:m.top,left:m.left,width:z.contentRect.width,height:z.contentRect.height}});const d=M=>W(M.source)&&W(M.target)?`M${M.source.x} ${M.source.y} L${M.target.x} ${M.target.y}`:void 0,{simulation:_,graph:y}=me(a.toRef(()=>r.nodes),a.toRef(()=>r.links),l,o),{dragStart:u,dragEnd:v,dragMove:p}=Fe(_,o.draggables),{label:k}=Yt(o.nodeFontSize,o.nodeSize),{label:w,getX:N,getY:R}=Xt(o.linkFontSize),{markers:T}=Pe(o.linkWidth,o.nodeSize,o.directed),E=(M,z,m)=>{n("node-click",M,r.nodes[m])},C=(M,z,m)=>{n("link-click",M,r.links[m])},S=M=>{if(!M.ctrlKey||!c.value)return;const z=M.deltaY||M.deltaX,m=Math.abs(z)<50?.05:.25,b=z<0?m:-m;i(M.clientX,M.clientY,b)},P=M=>{p(M),f(M.clientX,M.clientY)},I=M=>{g(M.clientX,M.clientY)},D=(M,z)=>u(M,z),J=()=>{v(),x()},q=()=>v();return(M,z)=>(a.openBlock(),a.createElementBlock("svg",{ref_key:"svg",ref:s,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",preserveAspectRatio:"xMinYMin",viewBox:`0 0 ${l.value.width} ${l.value.height}`,class:"svg-container",onMousedown:a.withModifiers(I,["self","prevent"]),onMouseup:J,onTouchendPassive:q,onTouchstartPassive:z[0]||(z[0]=async()=>{}),onMousemove:P,onWheel:a.withModifiers(S,["prevent"])},[a.unref(o).directed?(a.openBlock(),a.createElementBlock("defs",Ht,[a.createElementVNode("marker",a.normalizeProps(a.guardReactiveProps(a.unref(T).arrowEnd)),[a.createElementVNode("path",{fill:a.unref(t).link.stroke,d:"M0 -5 L 10 0 L 0 5"},null,8,Ut)],16),a.createElementVNode("marker",a.normalizeProps(a.guardReactiveProps(a.unref(T).arrowStart)),[a.createElementVNode("path",{fill:a.unref(t).link.stroke,d:"M 10 5 L 0 0 L 10 -5"},null,8,jt)],16)])):a.createCommentVNode("",!0),a.createElementVNode("g",{ref_key:"canvas",ref:c,class:"svg-canvas",transform:a.unref(h)},[a.createElementVNode("g",Ot,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(a.unref(y).links,(m,b)=>(a.openBlock(),a.createElementBlock(a.Fragment,{key:b},[a.createElementVNode("path",{id:`${b}`,d:d(m),"stroke-width":m["stroke-width"],class:a.normalizeClass(m.class),style:a.normalizeStyle(m.style),"marker-end":m["marker-end"],"marker-start":m["marker-start"],onClick:A=>C(A,m,b),onTouchstartPassive:A=>C(A,m,b)},null,46,Kt),a.createElementVNode("text",{class:"link-label","font-size":a.unref(w).font.size,x:a.unref(N)(m),y:a.unref(R)(m)},a.toDisplayString(m.name),9,Qt)],64))),128))]),a.createElementVNode("g",Zt,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(a.unref(y).nodes,(m,b)=>(a.openBlock(),a.createElementBlock(a.Fragment,{key:b},[m.innerSVG?(a.openBlock(),a.createElementBlock("svg",{key:0,viewBox:m.innerSVG.viewBox,width:m.width,height:m.height,x:(m.x||0)-(m.width||0)/2,y:(m.y||0)-(m.height||0)/2,style:a.normalizeStyle(m.style),title:m.name,class:a.normalizeClass(m.cssClass),onClick:A=>E(A,m,b),onTouchendPassive:A=>E(A,m,b),onMousedown:a.withModifiers(A=>D(A,b),["prevent"]),onTouchstartPassive:a.withModifiers(A=>D(A,b),["prevent"]),innerHTML:m.innerSVG.innerHtml},null,46,Jt)):(a.openBlock(),a.createElementBlock("circle",{key:1,cx:m.x,cy:m.y,r:m.r,style:a.normalizeStyle(m.style),title:m.name,class:a.normalizeClass(m.cssClass),onClick:A=>E(A,m,b),onTouchendPassive:A=>E(A,m,b),onMousedown:a.withModifiers(A=>D(A,b),["prevent"]),onTouchstartPassive:a.withModifiers(A=>D(A,b),["prevent"])},null,46,qt)),a.createElementVNode("text",{class:"node-label",x:(m.x||0)+(m.width||0)/2+a.unref(k).font.size/2,y:(m.y||0)+a.unref(k).offset.y,"font-size":a.unref(k).font.size},a.toDisplayString(m.name),9,en)],64))),128))])],8,Gt)],40,Wt))}}),nn="";$.D3NetworkGraph=tn,$.useSimulation=me,Object.defineProperty($,Symbol.toStringTag,{value:"Module"})});
