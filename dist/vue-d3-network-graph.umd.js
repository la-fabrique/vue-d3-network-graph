(function(z,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue"),require("@vueuse/core")):typeof define=="function"&&define.amd?define(["exports","vue","@vueuse/core"],a):(z=typeof globalThis<"u"?globalThis:z||self,a(z["vue-d3-network-graph"]={},z.Vue,z.VueUseCore))})(this,function(z,a,j){"use strict";function Fe(e,n){const r=a.ref(void 0),t=a.reactive({x:0,y:0}),i=h=>{let d,_=0;return h instanceof MouseEvent?(d=h.clientX,_=h.clientY):h instanceof TouchEvent&&(d=h.touches[0].clientX,_=h.touches[0].clientY),{x:d||0,y:_||0}},s=(h,d)=>n.value?(()=>{r.value=d,u(h,e.value.nodes()[d])})():void 0,u=(h,d)=>{let _=0,y=0;if(h&&d&&(d!=null&&d.x)&&(d!=null&&d.y)){const w=i(h);_=w.x?w.x-d.x:d.x,y=w.y?w.y-d.y:d.y}t.x=_,t.y=y},f=()=>{if(r.value!==void 0){const h=e.value.nodes()[r.value];h.fx=null,h.fy=null,v()}},v=()=>{r.value=void 0,e.value.alpha(.1),e.value.restart(),u()};return{dragStart:s,dragEnd:f,move:h=>{const d=i(h);r.value!=null&&e.value.nodes()[r.value]&&(e.value.restart(),e.value.alpha(.5),e.value.nodes()[r.value].fx=d.x-t.x,e.value.nodes()[r.value].fy=d.y-t.y)}}}const Z="arrow-start",J="arrow-end";function Ie(e,n,r){const t=u=>r.value&&u.twoWay?`url(#${Z})`:void 0,i=u=>r.value?`url(#${J})`:void 0,s=a.computed(()=>({arrowStart:{id:Z,refX:-(n.value/2-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"stroke-width":"1","marker-units":"userSpaceOnUse"},arrowEnd:{id:J,refX:n.value/2+(10-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"marker-units":"userSpaceOnUse"}}));return{getMarkerEnd:i,getMarkerStart:t,markers:s}}function Pe(e){const n=+this._x.call(null,e),r=+this._y.call(null,e);return q(this.cover(n,r),n,r,e)}function q(e,n,r,t){if(isNaN(n)||isNaN(r))return e;var i,s=e._root,u={data:t},f=e._x0,v=e._y0,o=e._x1,h=e._y1,d,_,y,w,g,c,l,x;if(!s)return e._root=u,e;for(;s.length;)if((g=n>=(d=(f+o)/2))?f=d:o=d,(c=r>=(_=(v+h)/2))?v=_:h=_,i=s,!(s=s[l=c<<1|g]))return i[l]=u,e;if(y=+e._x.call(null,s.data),w=+e._y.call(null,s.data),n===y&&r===w)return u.next=s,i?i[l]=u:e._root=u,e;do i=i?i[l]=new Array(4):e._root=new Array(4),(g=n>=(d=(f+o)/2))?f=d:o=d,(c=r>=(_=(v+h)/2))?v=_:h=_;while((l=c<<1|g)===(x=(w>=_)<<1|y>=d));return i[x]=s,i[l]=u,e}function Ye(e){var n,r,t=e.length,i,s,u=new Array(t),f=new Array(t),v=1/0,o=1/0,h=-1/0,d=-1/0;for(r=0;r<t;++r)isNaN(i=+this._x.call(null,n=e[r]))||isNaN(s=+this._y.call(null,n))||(u[r]=i,f[r]=s,i<v&&(v=i),i>h&&(h=i),s<o&&(o=s),s>d&&(d=s));if(v>h||o>d)return this;for(this.cover(v,o).cover(h,d),r=0;r<t;++r)q(this,u[r],f[r],e[r]);return this}function We(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var r=this._x0,t=this._y0,i=this._x1,s=this._y1;if(isNaN(r))i=(r=Math.floor(e))+1,s=(t=Math.floor(n))+1;else{for(var u=i-r||1,f=this._root,v,o;r>e||e>=i||t>n||n>=s;)switch(o=(n<t)<<1|e<r,v=new Array(4),v[o]=f,f=v,u*=2,o){case 0:i=r+u,s=t+u;break;case 1:r=i-u,s=t+u;break;case 2:i=r+u,t=s-u;break;case 3:r=i-u,t=s-u;break}this._root&&this._root.length&&(this._root=f)}return this._x0=r,this._y0=t,this._x1=i,this._y1=s,this}function Ve(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function Xe(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function S(e,n,r,t,i){this.node=e,this.x0=n,this.y0=r,this.x1=t,this.y1=i}function He(e,n,r){var t,i=this._x0,s=this._y0,u,f,v,o,h=this._x1,d=this._y1,_=[],y=this._root,w,g;for(y&&_.push(new S(y,i,s,h,d)),r==null?r=1/0:(i=e-r,s=n-r,h=e+r,d=n+r,r*=r);w=_.pop();)if(!(!(y=w.node)||(u=w.x0)>h||(f=w.y0)>d||(v=w.x1)<i||(o=w.y1)<s))if(y.length){var c=(u+v)/2,l=(f+o)/2;_.push(new S(y[3],c,l,v,o),new S(y[2],u,l,c,o),new S(y[1],c,f,v,l),new S(y[0],u,f,c,l)),(g=(n>=l)<<1|e>=c)&&(w=_[_.length-1],_[_.length-1]=_[_.length-1-g],_[_.length-1-g]=w)}else{var x=e-+this._x.call(null,y.data),p=n-+this._y.call(null,y.data),m=x*x+p*p;if(m<r){var k=Math.sqrt(r=m);i=e-k,s=n-k,h=e+k,d=n+k,t=y.data}}return t}function Ue(e){if(isNaN(h=+this._x.call(null,e))||isNaN(d=+this._y.call(null,e)))return this;var n,r=this._root,t,i,s,u=this._x0,f=this._y0,v=this._x1,o=this._y1,h,d,_,y,w,g,c,l;if(!r)return this;if(r.length)for(;;){if((w=h>=(_=(u+v)/2))?u=_:v=_,(g=d>=(y=(f+o)/2))?f=y:o=y,n=r,!(r=r[c=g<<1|w]))return this;if(!r.length)break;(n[c+1&3]||n[c+2&3]||n[c+3&3])&&(t=n,l=c)}for(;r.data!==e;)if(i=r,!(r=r.next))return this;return(s=r.next)&&delete r.next,i?(s?i.next=s:delete i.next,this):n?(s?n[c]=s:delete n[c],(r=n[0]||n[1]||n[2]||n[3])&&r===(n[3]||n[2]||n[1]||n[0])&&!r.length&&(t?t[l]=r:this._root=r),this):(this._root=s,this)}function je(e){for(var n=0,r=e.length;n<r;++n)this.remove(e[n]);return this}function Ge(){return this._root}function Oe(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function Ke(e){var n=[],r,t=this._root,i,s,u,f,v;for(t&&n.push(new S(t,this._x0,this._y0,this._x1,this._y1));r=n.pop();)if(!e(t=r.node,s=r.x0,u=r.y0,f=r.x1,v=r.y1)&&t.length){var o=(s+f)/2,h=(u+v)/2;(i=t[3])&&n.push(new S(i,o,h,f,v)),(i=t[2])&&n.push(new S(i,s,h,o,v)),(i=t[1])&&n.push(new S(i,o,u,f,h)),(i=t[0])&&n.push(new S(i,s,u,o,h))}return this}function Qe(e){var n=[],r=[],t;for(this._root&&n.push(new S(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var s,u=t.x0,f=t.y0,v=t.x1,o=t.y1,h=(u+v)/2,d=(f+o)/2;(s=i[0])&&n.push(new S(s,u,f,h,d)),(s=i[1])&&n.push(new S(s,h,f,v,d)),(s=i[2])&&n.push(new S(s,u,d,h,o)),(s=i[3])&&n.push(new S(s,h,d,v,o))}r.push(t)}for(;t=r.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}function Ze(e){return e[0]}function Je(e){return arguments.length?(this._x=e,this):this._x}function qe(e){return e[1]}function et(e){return arguments.length?(this._y=e,this):this._y}function G(e,n,r){var t=new O(n??Ze,r??qe,NaN,NaN,NaN,NaN);return e==null?t:t.addAll(e)}function O(e,n,r,t,i,s){this._x=e,this._y=n,this._x0=r,this._y0=t,this._x1=i,this._y1=s,this._root=void 0}function ee(e){for(var n={data:e.data},r=n;e=e.next;)r=r.next={data:e.data};return n}var R=G.prototype=O.prototype;R.copy=function(){var e=new O(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,r,t;if(!n)return e;if(!n.length)return e._root=ee(n),e;for(r=[{source:n,target:e._root=new Array(4)}];n=r.pop();)for(var i=0;i<4;++i)(t=n.source[i])&&(t.length?r.push({source:t,target:n.target[i]=new Array(4)}):n.target[i]=ee(t));return e},R.add=Pe,R.addAll=Ye,R.cover=We,R.data=Ve,R.extent=Xe,R.find=He,R.remove=Ue,R.removeAll=je,R.root=Ge,R.size=Oe,R.visit=Ke,R.visitAfter=Qe,R.x=Je,R.y=et;function T(e){return function(){return e}}function L(e){return(e()-.5)*1e-6}function tt(e){return e.x+e.vx}function nt(e){return e.y+e.vy}function rt(e){var n,r,t,i=1,s=1;typeof e!="function"&&(e=T(e==null?1:+e));function u(){for(var o,h=n.length,d,_,y,w,g,c,l=0;l<s;++l)for(d=G(n,tt,nt).visitAfter(f),o=0;o<h;++o)_=n[o],g=r[_.index],c=g*g,y=_.x+_.vx,w=_.y+_.vy,d.visit(x);function x(p,m,k,M,A){var N=p.data,C=p.r,E=g+C;if(N){if(N.index>_.index){var B=y-N.x-N.vx,b=w-N.y-N.vy,D=B*B+b*b;D<E*E&&(B===0&&(B=L(t),D+=B*B),b===0&&(b=L(t),D+=b*b),D=(E-(D=Math.sqrt(D)))/D*i,_.vx+=(B*=D)*(E=(C*=C)/(c+C)),_.vy+=(b*=D)*E,N.vx-=B*(E=1-E),N.vy-=b*E)}return}return m>y+E||M<y-E||k>w+E||A<w-E}}function f(o){if(o.data)return o.r=r[o.data.index];for(var h=o.r=0;h<4;++h)o[h]&&o[h].r>o.r&&(o.r=o[h].r)}function v(){if(n){var o,h=n.length,d;for(r=new Array(h),o=0;o<h;++o)d=n[o],r[d.index]=+e(d,o,n)}}return u.initialize=function(o,h){n=o,t=h,v()},u.iterations=function(o){return arguments.length?(s=+o,u):s},u.strength=function(o){return arguments.length?(i=+o,u):i},u.radius=function(o){return arguments.length?(e=typeof o=="function"?o:T(+o),v(),u):e},u}function it(e){return e.index}function te(e,n){var r=e.get(n);if(!r)throw new Error("node not found: "+n);return r}function ot(e){var n=it,r=d,t,i=T(30),s,u,f,v,o,h=1;e==null&&(e=[]);function d(c){return 1/Math.min(f[c.source.index],f[c.target.index])}function _(c){for(var l=0,x=e.length;l<h;++l)for(var p=0,m,k,M,A,N,C,E;p<x;++p)m=e[p],k=m.source,M=m.target,A=M.x+M.vx-k.x-k.vx||L(o),N=M.y+M.vy-k.y-k.vy||L(o),C=Math.sqrt(A*A+N*N),C=(C-s[p])/C*c*t[p],A*=C,N*=C,M.vx-=A*(E=v[p]),M.vy-=N*E,k.vx+=A*(E=1-E),k.vy+=N*E}function y(){if(u){var c,l=u.length,x=e.length,p=new Map(u.map((k,M)=>[n(k,M,u),k])),m;for(c=0,f=new Array(l);c<x;++c)m=e[c],m.index=c,typeof m.source!="object"&&(m.source=te(p,m.source)),typeof m.target!="object"&&(m.target=te(p,m.target)),f[m.source.index]=(f[m.source.index]||0)+1,f[m.target.index]=(f[m.target.index]||0)+1;for(c=0,v=new Array(x);c<x;++c)m=e[c],v[c]=f[m.source.index]/(f[m.source.index]+f[m.target.index]);t=new Array(x),w(),s=new Array(x),g()}}function w(){if(u)for(var c=0,l=e.length;c<l;++c)t[c]=+r(e[c],c,e)}function g(){if(u)for(var c=0,l=e.length;c<l;++c)s[c]=+i(e[c],c,e)}return _.initialize=function(c,l){u=c,o=l,y()},_.links=function(c){return arguments.length?(e=c,y(),_):e},_.id=function(c){return arguments.length?(n=c,_):n},_.iterations=function(c){return arguments.length?(h=+c,_):h},_.strength=function(c){return arguments.length?(r=typeof c=="function"?c:T(+c),w(),_):r},_.distance=function(c){return arguments.length?(i=typeof c=="function"?c:T(+c),g(),_):i},_}var lt={value:()=>{}};function ne(){for(var e=0,n=arguments.length,r={},t;e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new V(r)}function V(e){this._=e}function at(e,n){return e.trim().split(/^|\s+/).map(function(r){var t="",i=r.indexOf(".");if(i>=0&&(t=r.slice(i+1),r=r.slice(0,i)),r&&!n.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:t}})}V.prototype=ne.prototype={constructor:V,on:function(e,n){var r=this._,t=at(e+"",r),i,s=-1,u=t.length;if(arguments.length<2){for(;++s<u;)if((i=(e=t[s]).type)&&(i=st(r[i],e.name)))return i;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++s<u;)if(i=(e=t[s]).type)r[i]=re(r[i],e.name,n);else if(n==null)for(i in r)r[i]=re(r[i],e.name,null);return this},copy:function(){var e={},n=this._;for(var r in n)e[r]=n[r].slice();return new V(e)},call:function(e,n){if((i=arguments.length-2)>0)for(var r=new Array(i),t=0,i,s;t<i;++t)r[t]=arguments[t+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],t=0,i=s.length;t<i;++t)s[t].value.apply(n,r)},apply:function(e,n,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var t=this._[e],i=0,s=t.length;i<s;++i)t[i].value.apply(n,r)}};function st(e,n){for(var r=0,t=e.length,i;r<t;++r)if((i=e[r]).name===n)return i.value}function re(e,n,r){for(var t=0,i=e.length;t<i;++t)if(e[t].name===n){e[t]=lt,e=e.slice(0,t).concat(e.slice(t+1));break}return r!=null&&e.push({name:n,value:r}),e}var F=0,I=0,P=0,ie=1e3,X,Y,H=0,$=0,U=0,W=typeof performance=="object"&&performance.now?performance:Date,oe=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function le(){return $||(oe(ft),$=W.now()+U)}function ft(){$=0}function K(){this._call=this._time=this._next=null}K.prototype=ae.prototype={constructor:K,restart:function(e,n,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?le():+r)+(n==null?0:+n),!this._next&&Y!==this&&(Y?Y._next=this:X=this,Y=this),this._call=e,this._time=r,Q()},stop:function(){this._call&&(this._call=null,this._time=1/0,Q())}};function ae(e,n,r){var t=new K;return t.restart(e,n,r),t}function ct(){le(),++F;for(var e=X,n;e;)(n=$-e._time)>=0&&e._call.call(void 0,n),e=e._next;--F}function se(){$=(H=W.now())+U,F=I=0;try{ct()}finally{F=0,ht(),$=0}}function ut(){var e=W.now(),n=e-H;n>ie&&(U-=n,H=e)}function ht(){for(var e,n=X,r,t=1/0;n;)n._call?(t>n._time&&(t=n._time),e=n,n=n._next):(r=n._next,n._next=null,n=e?e._next=r:X=r);Y=e,Q(t)}function Q(e){if(!F){I&&(I=clearTimeout(I));var n=e-$;n>24?(e<1/0&&(I=setTimeout(se,e-W.now()-U)),P&&(P=clearInterval(P))):(P||(H=W.now(),P=setInterval(ut,ie)),F=1,oe(se))}}const gt=1664525,yt=1013904223,fe=4294967296;function dt(){let e=1;return()=>(e=(gt*e+yt)%fe)/fe}function vt(e){return e.x}function _t(e){return e.y}var xt=10,mt=Math.PI*(3-Math.sqrt(5));function ce(e){var n,r=1,t=.001,i=1-Math.pow(t,1/300),s=0,u=.6,f=new Map,v=ae(d),o=ne("tick","end"),h=dt();e==null&&(e=[]);function d(){_(),o.call("tick",n),r<t&&(v.stop(),o.call("end",n))}function _(g){var c,l=e.length,x;g===void 0&&(g=1);for(var p=0;p<g;++p)for(r+=(s-r)*i,f.forEach(function(m){m(r)}),c=0;c<l;++c)x=e[c],x.fx==null?x.x+=x.vx*=u:(x.x=x.fx,x.vx=0),x.fy==null?x.y+=x.vy*=u:(x.y=x.fy,x.vy=0);return n}function y(){for(var g=0,c=e.length,l;g<c;++g){if(l=e[g],l.index=g,l.fx!=null&&(l.x=l.fx),l.fy!=null&&(l.y=l.fy),isNaN(l.x)||isNaN(l.y)){var x=xt*Math.sqrt(.5+g),p=g*mt;l.x=x*Math.cos(p),l.y=x*Math.sin(p)}(isNaN(l.vx)||isNaN(l.vy))&&(l.vx=l.vy=0)}}function w(g){return g.initialize&&g.initialize(e,h),g}return y(),n={tick:_,restart:function(){return v.restart(d),n},stop:function(){return v.stop(),n},nodes:function(g){return arguments.length?(e=g,y(),f.forEach(w),n):e},alpha:function(g){return arguments.length?(r=+g,n):r},alphaMin:function(g){return arguments.length?(t=+g,n):t},alphaDecay:function(g){return arguments.length?(i=+g,n):+i},alphaTarget:function(g){return arguments.length?(s=+g,n):s},velocityDecay:function(g){return arguments.length?(u=1-g,n):1-u},randomSource:function(g){return arguments.length?(h=g,f.forEach(w),n):h},force:function(g,c){return arguments.length>1?(c==null?f.delete(g):f.set(g,w(c)),n):f.get(g)},find:function(g,c,l){var x=0,p=e.length,m,k,M,A,N;for(l==null?l=1/0:l*=l,x=0;x<p;++x)A=e[x],m=g-A.x,k=c-A.y,M=m*m+k*k,M<l&&(N=A,l=M);return N},on:function(g,c){return arguments.length>1?(o.on(g,c),n):o.on(g)}}}function wt(){var e,n,r,t,i=T(-30),s,u=1,f=1/0,v=.81;function o(y){var w,g=e.length,c=G(e,vt,_t).visitAfter(d);for(t=y,w=0;w<g;++w)n=e[w],c.visit(_)}function h(){if(e){var y,w=e.length,g;for(s=new Array(w),y=0;y<w;++y)g=e[y],s[g.index]=+i(g,y,e)}}function d(y){var w=0,g,c,l=0,x,p,m;if(y.length){for(x=p=m=0;m<4;++m)(g=y[m])&&(c=Math.abs(g.value))&&(w+=g.value,l+=c,x+=c*g.x,p+=c*g.y);y.x=x/l,y.y=p/l}else{g=y,g.x=g.data.x,g.y=g.data.y;do w+=s[g.data.index];while(g=g.next)}y.value=w}function _(y,w,g,c){if(!y.value)return!0;var l=y.x-n.x,x=y.y-n.y,p=c-w,m=l*l+x*x;if(p*p/v<m)return m<f&&(l===0&&(l=L(r),m+=l*l),x===0&&(x=L(r),m+=x*x),m<u&&(m=Math.sqrt(u*m)),n.vx+=l*y.value*t/m,n.vy+=x*y.value*t/m),!0;if(y.length||m>=f)return;(y.data!==n||y.next)&&(l===0&&(l=L(r),m+=l*l),x===0&&(x=L(r),m+=x*x),m<u&&(m=Math.sqrt(u*m)));do y.data!==n&&(p=s[y.data.index]*t/m,n.vx+=l*p,n.vy+=x*p);while(y=y.next)}return o.initialize=function(y,w){e=y,r=w,h()},o.strength=function(y){return arguments.length?(i=typeof y=="function"?y:T(+y),h(),o):i},o.distanceMin=function(y){return arguments.length?(u=y*y,o):Math.sqrt(u)},o.distanceMax=function(y){return arguments.length?(f=y*y,o):Math.sqrt(f)},o.theta=function(y){return arguments.length?(v=y*y,o):Math.sqrt(v)},o}function pt(e){var n=T(.1),r,t,i;typeof e!="function"&&(e=T(e==null?0:+e));function s(f){for(var v=0,o=r.length,h;v<o;++v)h=r[v],h.vx+=(i[v]-h.x)*t[v]*f}function u(){if(r){var f,v=r.length;for(t=new Array(v),i=new Array(v),f=0;f<v;++f)t[f]=isNaN(i[f]=+e(r[f],f,r))?0:+n(r[f],f,r)}}return s.initialize=function(f){r=f,u()},s.strength=function(f){return arguments.length?(n=typeof f=="function"?f:T(+f),u(),s):n},s.x=function(f){return arguments.length?(e=typeof f=="function"?f:T(+f),u(),s):e},s}function kt(e){var n=T(.1),r,t,i;typeof e!="function"&&(e=T(e==null?0:+e));function s(f){for(var v=0,o=r.length,h;v<o;++v)h=r[v],h.vy+=(i[v]-h.y)*t[v]*f}function u(){if(r){var f,v=r.length;for(t=new Array(v),i=new Array(v),f=0;f<v;++f)t[f]=isNaN(i[f]=+e(r[f],f,r))?0:+n(r[f],f,r)}}return s.initialize=function(f){r=f,u()},s.strength=function(f){return arguments.length?(n=typeof f=="function"?f:T(+f),u(),s):n},s.y=function(f){return arguments.length?(e=typeof f=="function"?f:T(+f),u(),s):e},s}function Nt(e){const n=o=>o||e.value,r=o=>o.width||e.value,t=o=>o.height||o.size||e.value,i=o=>o.color?"fill: "+o.color:"",s=(o,h,d)=>h||d?["node","pinned"]:["node"];return{getNode:o=>({id:o.id,key:o.id,viewBox:o.innerSVG,width:r(o),height:t(o),name:o.name,style:i(o),title:o.name,cssClass:s(o.cssClass,void 0,void 0),r:o.innerSVG?void 0:n(o.size)/2}),getClass:s,getSize:n,getX:(o,h)=>(o||0)-(h||0)/2,getY:(o,h)=>(o||0)-(h||0)/2}}const ue="arrow-start",he="arrow-end";function Et(e,n,r){const t=o=>o.color?{stroke:o.color}:{},i=o=>["link"],s=o=>r.value&&o.twoWay?`url(#${ue})`:void 0,u=o=>r.value?`url(#${he})`:void 0,f=a.computed(()=>({arrowStart:{id:ue,refX:-(n.value/2-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"stroke-width":"1","marker-units":"userSpaceOnUse"},arrowEnd:{id:he,refX:n.value/2+(10-e.value),refY:0,viewBox:`0 -${5*e.value} ${10*e.value} ${10*e.value}`,orient:"auto",markerWidth:10+e.value,markerHeight:10+e.value,"marker-units":"userSpaceOnUse"}}));return{getClass:i,getStyle:t,getMarkerEnd:u,getMarkerStart:s,getSimulationLink:o=>({source:o.source,target:o.target,id:o.id,key:o.id,class:i(o.id),style:t(o),"stroke-width":e.value,"marker-end":u(),"marker-start":s(o)}),markers:f}}const Mt="X",At="Y",St="charge",Rt="link",Tt="collide",ge=.01,ye=.1,Ct=Math.log(ge)/Math.log(1-ye);function de(e,n,r,t){const{getNode:i}=Nt(t.nodeSize),{getSimulationLink:s}=Et(t.linkWidth,t.nodeSize,t.directed),u=a.reactive({nodes:[],links:[]}),f=()=>{console.debug("useSimulation.init"),u.nodes=e.value.map(d=>i(d)),u.links=n.value.map(d=>s(d)),v()},v=async()=>{console.debug("useSimulation.refresh"),h.value.stop(),h.value=o(),t.static.value?h.value.tick(Ct):h.value.restart()},o=()=>{const d=ce().alphaMin(ge).alphaDecay(ye).nodes(u.nodes);return d.force(Mt,pt(r.value.width/2).strength(t.forceXStrength.value)),d.force(At,kt(r.value.height/2).strength(t.forceYStrength.value)),d.force(St,wt().strength(t.forcManyBodyStrength.value)),d.force(Tt,rt(t.forceCollideStrength.value)),d.force(Rt,ot(u.links).id(_=>{if(!("id"in _))throw new Error("Node id is undefined");return _.id})),d},h=a.ref(ce());return j.watchDebounced([()=>e.value.length,()=>n.value.length,r,t.nodeSize,t.linkWidth,t.forcManyBodyStrength,t.forceXStrength,t.forceYStrength,t.forceCollideStrength,t.directed],async()=>f(),{debounce:100,maxWait:1e3}),j.watchDebounced(t.static,async()=>v(),{deep:!0,debounce:100,maxWait:1e3}),{simulation:h,graph:u}}const Dt=.1,Bt=.1,bt=-300,zt=25,Lt=12,$t=2,Ft=45,It=e=>{const n=a.computed(()=>{var t,i,s,u,f,v,o,h,d,_,y,w,g,c,l,x,p,m,k,M,A,N,C,E,B,b,D,ve,_e,xe,me,we,pe,ke,Ne,Ee,Me,Ae,Se,Re,Te,Ce,De,Be,be,ze,Le,$e;return{node:{stroke:((s=(i=(t=e.value)==null?void 0:t.nodes)==null?void 0:i.colors)==null?void 0:s.stroke)||"#E2EB98",fill:((v=(f=(u=e.value)==null?void 0:u.nodes)==null?void 0:f.colors)==null?void 0:v.fill)||"#93A392",selected:{stroke:((_=(d=(h=(o=e.value)==null?void 0:o.nodes)==null?void 0:h.colors)==null?void 0:d.selected)==null?void 0:_.stroke)||"#9DC4B5",fill:(c=(g=(w=(y=e.value)==null?void 0:y.nodes)==null?void 0:w.colors)==null?void 0:g.selected)==null?void 0:c.fill},hover:{stroke:"#9DC4B5",fill:(m=(p=(x=(l=e.value)==null?void 0:l.nodes)==null?void 0:x.colors)==null?void 0:p.hover)==null?void 0:m.fill},pinned:{stroke:"#9DC4B5",fill:(N=(A=(M=(k=e.value)==null?void 0:k.nodes)==null?void 0:M.colors)==null?void 0:A.pinned)==null?void 0:N.fill},label:{fill:((b=(B=(E=(C=e.value)==null?void 0:C.nodes)==null?void 0:E.colors)==null?void 0:B.label)==null?void 0:b.fill)||"#93A392"}},link:{stroke:((_e=(ve=(D=e.value)==null?void 0:D.links)==null?void 0:ve.colors)==null?void 0:_e.stroke)||"#BAD9A2",fill:(we=(me=(xe=e.value)==null?void 0:xe.links)==null?void 0:me.colors)==null?void 0:we.fill,selected:{stroke:((Ee=(Ne=(ke=(pe=e.value)==null?void 0:pe.links)==null?void 0:ke.colors)==null?void 0:Ne.selected)==null?void 0:Ee.stroke)||"#9DC4B5",fill:(Re=(Se=(Ae=(Me=e.value)==null?void 0:Me.links)==null?void 0:Ae.colors)==null?void 0:Se.selected)==null?void 0:Re.fill},hover:{stroke:"#9DC4B5",fill:(Be=(De=(Ce=(Te=e.value)==null?void 0:Te.links)==null?void 0:Ce.colors)==null?void 0:De.hover)==null?void 0:Be.fill},label:{fill:(($e=(Le=(ze=(be=e.value)==null?void 0:be.links)==null?void 0:ze.colors)==null?void 0:Le.label)==null?void 0:$e.fill)||"#93A392"}}}});return{options:{static:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.simulation)==null?void 0:i.static)||!1}),forceXStrength:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.simulation)==null?void 0:i.force.x)||Dt}),forceYStrength:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.simulation)==null?void 0:i.force.y)||Bt}),forcManyBodyStrength:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.simulation)==null?void 0:i.force.charge)||bt}),forceCollideStrength:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.simulation)==null?void 0:i.force.collide)||Ft}),nodeSize:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.nodes)==null?void 0:i.size)||zt}),nodeFontSize:a.toRef(()=>{var t,i,s;return((s=(i=(t=e.value)==null?void 0:t.nodes)==null?void 0:i.font)==null?void 0:s.size)||Lt}),linkWidth:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.links)==null?void 0:i.width)||$t}),draggables:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.layout)==null?void 0:i.draggables)||!1}),directed:a.toRef(()=>{var t,i;return((i=(t=e.value)==null?void 0:t.layout)==null?void 0:i.directed)||!1})},theme:n}},Pt=(e,n)=>({label:a.computed(()=>({font:{size:e.value},offset:{x:n.value/2+e.value/2,y:e.value/2}}))}),Yt=["viewBox"],Wt={key:0},Vt=["fill"],Xt=["fill"],Ht={id:"l-links",class:"links"},Ut=["id","d","stroke-width","marker-end","marker-start","onClick","onTouchstartPassive"],jt={id:"l-nodes",class:"nodes"},Gt=["viewBox","width","height","x","y","title","onClick","onTouchendPassive","onMousedown","onTouchstartPassive","innerHTML"],Ot=["cx","cy","r","title","onClick","onTouchendPassive","onMousedown","onTouchstartPassive"],Kt=["x","y","font-size","stroke-width"],Qt=a.defineComponent({__name:"D3NetworkGraph",props:{nodes:{type:Array,required:!0},links:{type:Array,required:!0},options:{type:Object,default:void 0}},emits:["node-click","link-click"],setup(e,{emit:n}){const r=e;a.useCssVars(g=>({"047c58d8":a.unref(t).node.stroke,e521ffba:a.unref(t).node.fill,19743914:a.unref(t).node.selected.stroke||a.unref(t).node.stroke,efb0e518:a.unref(t).node.selected.fill||a.unref(t).node.fill,"222f165e":a.unref(t).node.pinned.stroke||a.unref(t).node.stroke,"183da09e":a.unref(t).node.pinned.fill||a.unref(t).node.fill,"3f1c9a16":a.unref(t).node.hover.stroke||a.unref(t).node.stroke,"37e71fd5":a.unref(t).node.hover.fill||a.unref(t).node.fill,"5aedafe0":a.unref(t).link.stroke,"10da792b":a.unref(t).link.fill,"7c9a3843":a.unref(t).link.selected.stroke,"47c3be4e":a.unref(t).link.selected.fill,e7f9bc6c:a.unref(t).node.hover.stroke,"7d975d95":a.unref(t).node.hover.fill,e8ede436:a.unref(t).link.label.fill,"0b2a7add":a.unref(t).node.label.fill}));const{theme:t,options:i}=It(a.toRef(()=>r.options)),s=a.ref(null),u=a.ref({width:100,height:100});j.useResizeObserver(s,g=>{const c=g[0];c.contentRect.width===u.value.width&&c.contentRect.height===u.value.height||(u.value={width:c.contentRect.width,height:c.contentRect.height})});const f=g=>typeof g.source!="number"&&typeof g.source!="string"&&typeof g.target!="number"&&typeof g.target!="string"?`M${g.source.x} ${g.source.y} L${g.target.x} ${g.target.y}`:void 0,{simulation:v,graph:o}=de(a.toRef(()=>r.nodes),a.toRef(()=>r.links),u,i),{dragStart:h,dragEnd:d,move:_}=Fe(v,i.draggables),{label:y}=Pt(i.nodeFontSize,i.nodeSize),{markers:w}=Ie(i.linkWidth,i.nodeSize,i.directed);return(g,c)=>(a.openBlock(),a.createElementBlock("svg",{ref_key:"svg",ref:s,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",preserveAspectRatio:"xMinYMin",viewBox:`0 0 ${u.value.width} ${u.value.height}`,class:"svg-container",onMouseup:c[0]||(c[0]=(...l)=>a.unref(d)&&a.unref(d)(...l)),onTouchendPassive:c[1]||(c[1]=(...l)=>a.unref(d)&&a.unref(d)(...l)),onTouchstartPassive:c[2]||(c[2]=async()=>{}),onMousemove:c[3]||(c[3]=(...l)=>a.unref(_)&&a.unref(_)(...l))},[a.unref(i).directed?(a.openBlock(),a.createElementBlock("defs",Wt,[a.createElementVNode("marker",a.normalizeProps(a.guardReactiveProps(a.unref(w).arrowEnd)),[a.createElementVNode("path",{fill:a.unref(t).link.stroke,d:"M0 -5 L 10 0 L 0 5"},null,8,Vt)],16),a.createElementVNode("marker",a.normalizeProps(a.guardReactiveProps(a.unref(w).arrowStart)),[a.createElementVNode("path",{fill:a.unref(t).link.stroke,d:"M 10 5 L 0 0 L 10 -5"},null,8,Xt)],16)])):a.createCommentVNode("",!0),a.createElementVNode("g",Ht,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(a.unref(o).links,l=>(a.openBlock(),a.createElementBlock("path",{id:l.id,key:l.id,d:f(l),"stroke-width":l["stroke-width"],class:a.normalizeClass(l.class),style:a.normalizeStyle(l.style),"marker-end":l["marker-end"],"marker-start":l["marker-start"],onClick:x=>n("link-click",x,l),onTouchstartPassive:x=>n("link-click",x,l)},null,46,Ut))),128))]),a.createElementVNode("g",jt,[(a.openBlock(!0),a.createElementBlock(a.Fragment,null,a.renderList(a.unref(o).nodes,(l,x)=>(a.openBlock(),a.createElementBlock(a.Fragment,{key:x},[l.innerSVG?(a.openBlock(),a.createElementBlock("svg",{key:0,viewBox:l.innerSVG.viewBox,width:l.width,height:l.height,x:(l.x||0)-(l.width||0)/2,y:(l.y||0)-(l.height||0)/2,style:a.normalizeStyle(l.style),title:l.name,class:a.normalizeClass(l.cssClass),onClick:p=>n("node-click",p,l),onTouchendPassive:p=>n("node-click",p,l),onMousedown:a.withModifiers(p=>a.unref(h)(p,x),["prevent"]),onTouchstartPassive:a.withModifiers(p=>a.unref(h)(p,x),["prevent"]),innerHTML:l.innerSVG.innerHtml},null,46,Gt)):(a.openBlock(),a.createElementBlock("circle",{key:1,cx:l.x,cy:l.y,r:l.r,style:a.normalizeStyle(l.style),title:l.name,class:a.normalizeClass(l.cssClass),onClick:p=>g.$emit("node-click",p,l),onTouchendPassive:p=>g.$emit("node-click",p,l),onMousedown:a.withModifiers(p=>a.unref(h)(p,x),["prevent"]),onTouchstartPassive:a.withModifiers(p=>a.unref(h)(p,x),["prevent"])},null,46,Ot)),a.createElementVNode("text",{class:"node-label",x:(l.x||0)+(l.width||0)/2+a.unref(y).font.size/2,y:(l.y||0)+a.unref(y).offset.y,"font-size":a.unref(y).font.size,"stroke-width":a.unref(y).font.size/8},a.toDisplayString(l.name),9,Kt)],64))),128))])],40,Yt))}}),Zt="";z.D3NetworkGraph=Qt,z.useSimulation=de,Object.defineProperty(z,Symbol.toStringTag,{value:"Module"})});
